<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge;chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    {% if opengraph %}
      <meta property="og:{{property}}" content="{{content}}" />
    {% endif %}
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/socialshare.min.css" type="text/css" media="all" />
    <link rel="stylesheet" href="/css/bootstrap-2.0.2.min.css" />
    <link href="//www.mozilla.org/tabzilla/media/css/tabzilla.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="all" />
    <title dir="ltr">Open Badge Backpack</title>
    <script type="text/javascript" src="/js/modernizr.js"></script>
    <script type="text/javascript" src="https://login.persona.org/include.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-35433268-10']);
      _gaq.push(['_setDomainName', 'openbadges.org']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container" style="position: relative;">
          <h3><a class="brand" href="/">
            Open Badge Backpack
            {% if settings.env == 'development' %}
              <small class="env" title="{{ settings.sha|d('') }}">{{ settings.env }}</small>
            {% endif %}
          </a></h3>
          <a href="http://www.mozilla.org/" id="tabzilla">a mozilla.org joint</a>
          <ul class="nav">
            <li><a href="/">Home</a></li>
            <li><a href="/{% if not tooltips %}?tooltips{% endif %}">
              Help: {% if tooltips %}Off{% else %}On{% endif %}
            </a></li>
          </ul>
            <ul class="nav pull-right">
            {% if user %}
              <li class="user">{{user.attributes.email}}</li>
              <li><a class="js-browserid-logout" href="#">Sign Out</a></li>
            {% else %}
              <li><a class="js-browserid-link" href="#">Sign In</a></li>
            {% endif %}
            </ul>
        </div>
      </div>
    </div>

    <div id="body" class="container">
      <div class='message-container'>
      {% for e in error %}
        <div class="alert alert-error">
          <a class="close" data-dismiss="alert">×</a>
          {{e}}
        </div>
      {% endfor %}

      {% for s in success %}
        <div class="alert alert-success">
          <a class="close" data-dismiss="alert">×</a>
          {{s}}
        </div>
      {% endfor %}
      </div>

      {% block body %}{% endblock %}
    </div>

    <div id="footer" class="container">
      <aside>
        <h2>Legal</h2>
        <ul>
          <li><a href="/tou.html">Terms of Use</a></li>
          <li><a href="/privacy.html">Privacy Policy</a></li>
          <li><a href="/vpat.html">Accessibility</a></li>
        </ul>
      </aside>
    </div>

    <script src="//www.mozilla.org/tabzilla/media/js/tabzilla.js"></script>
    <script src="/js/require-config.js"></script>
    <script src="/js/require.min.js"></script>
    <script type="text/javascript">
      require(['browserid-ajax'], function(BrowserIDAjax){
        var browserid = BrowserIDAjax({
          {% if user %}
          email: "{{ user.attributes.email }}",
          {% else %}
          email: null,
          {% endif %}
          verifyURL: '/backpack/authenticate',
          logoutURL: '/backpack/signout',
          csrfToken: '{{ csrfToken }}'
        }).on('login:error', function() {
          console.log('error');
        }).on('login', function() {
          console.log('woot');
          window.location.reload();
        }).on('logout', function() {
          console.log('logout');
          window.location.reload();
        }).on('logout:error', function() {
          console.log('wat');
        });

        $('.js-browserid-link').bind('click', function(){
          browserid.login();
        });
        $('.js-browserid-logout').bind('click', function(){
          browserid.logout();
        });
      });
    </script>
    {% block scripts %}{% endblock %}

  </body>
</html>
